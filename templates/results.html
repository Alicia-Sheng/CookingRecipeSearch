{% extends "home.html" %}

{% block banner_search %}
{% endblock %}

{% block cards %}
{% endblock %}

{% block search %}
<div class="jumbotron jumbotron-fluid bg-info text-white text-cente">
    <div class="container">
        <form action="{{ url_for('test_results') }}" name="search" method="POST">
            <div class="form-row align-items-center">
                <div class="col-md-8 mb-3">
                    <input type="text" class="form-control" name="query_text" placeholder="what's next" aria-label="Text input with dropdown button">
                </div>
                <div class="col-md-2 mb-3">
                <label class="mr-sm-2 sr-only" for="inlineFormCustomSelect">Preference</label>
                <select class="custom-select mr-sm-2" name="query_type" id="inlineFormCustomSelect">
                    <option selected value="default">Default</option>
                    <option value="healthiness">Healthiness</option>
                    <option value="complexity">Complexity</option>
                    <option value="ingredients">Ingredients</option>
                </select>
                </div>
                <div class="col-md-2 mb-3">
                <button type="submit" class="btn btn-outline-light">Search</button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block result_display %}
    {% if doc|length != 0 %}
        {% for d in doc %}
            {% set index = (page_id - 1)*8 + loop.index - 1 %}
            <div class="container">
                <h6>
                    <a href="{{ url_for('doc', doc_id=result_id[index]) }}">{{d.title}}</a>
                </h6>
                <div class="container">
                    <p>
                    {% for index in range(d['ingredients']|length) %}
                        <strong>{{d['ingredients'][index]}}</strong> :&nbsp; {{d['ingredients_description'][index]}}
                    {% endfor %}
                    </p>
                </div>
                <p>
                    {% for nutr, level in d['health'].items() %}
                        {{nutr}} :&nbsp; {{level}}
                    {% endfor %}
                </p>
                <p>Complexity: {{d['complexity']}}</p>
                <hr>
            </div>
        {% endfor %}
    {% endif %}

{% endblock %}


{% block next_page %}
<div class="container">
    <nav aria-label="...">
        <ul class="pagination mx-auto justify-content-center">
            {# Determines whether previous button disabled #}
            {% if prev_disabled %}
                <li class="page-item disabled">
                    <input type="submit" value="Previous" class="btn btn-outline-secondary btn-sm">
                </li>
            {% else %}
                <li class="page-item">
                    <form action="{{ url_for('next_page', page_id=page_id - 1)}}" name="Prev_page" method="post">
                        <input name="results" type="hidden" value="{{ results }}">
                        <input name="result_id" type="hidden" value="{{ result_id }}">
                        <input name="query_text" type="hidden" value="{{ query_text }}">
                        <input name="num_page" type="hidden" value="{{ num_page }}">
                        <input type="submit" value="Previous" class="btn btn-outline-secondary btn-sm">
                    </form>
                </li>
            {% endif %}

            {% for id in range(num_page) %}
                <li class="page-item">
                    <form action="{{ url_for('next_page', page_id=id + 1) }}" name="Pagination" method="post">
                        <input name="results" type="hidden" value="{{ results }}">
                        <input name="result_id" type="hidden" value="{{ result_id }}">
                        <input name="query_text" type="hidden" value="{{ query_text }}">
                        <input name="num_page" type="hidden" value="{{ num_page }}">
                        <input type="submit" value="{{ id + 1 }}" class="btn btn-outline-secondary btn-sm">
                    </form>
                </li>
            {% endfor %}

            {# Determines whether next button disabled #}
            {% if next_disabled %}
                <li class="page-item disabled">
                    <input type="submit" value="Next" class="btn btn-outline-secondary btn-sm">
                </li>
            {% else %}
                <li class="page-item">
                    <form action="{{ url_for('next_page', page_id=page_id + 1) }}" name="Pagination" method="post">
                        <input name="results" type="hidden" value="{{ results }}">
                        <input name="result_id" type="hidden" value="{{ result_id }}">
                        <input name="query_text" type="hidden" value="{{ query_text }}">
                        <input name="num_page" type="hidden" value="{{ num_page }}">
                        <input type="submit" value="Next" class="btn btn-outline-secondary btn-sm">
                    </form>
                </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endblock %}