{% extends "layout.html" %}

{% block search %}
<div class="jumbotron jumbotron-fluid bg-info text-white text-cente">
    <div class="container">
        <form action="{{ url_for('test_results') }}" name="search" method="POST">
            <div class="form-row align-items-center">
                <div class="col-md-8 mb-3">
                    <input type="text" class="form-control" name="query_text" placeholder="what's next" aria-label="Text input with dropdown button">
                </div>
                <div class="col-md-2 mb-3">
                <label class="mr-sm-2 sr-only" for="inlineFormCustomSelect">Preference</label>
                <select class="custom-select mr-sm-2" name="query_type" id="inlineFormCustomSelect">
                    <option selected value="default">Default</option>
                    <option value="healthiness">Healthiness</option>
                    <option value="complexity">Complexity</option>
                    <option value="ingredients">Ingredients</option>
                </select>
                </div>
                <div class="col-md-2 mb-3">
                <button type="submit" class="btn btn-outline-light">Search</button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block health_search %}
    {# if search by healthiness #}
    {% if search_health %}

    {% else %}
    {% endif %}
<div class="container">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Home</a>
        </li>
        <li class="nav-item">
        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Profile</a>
        </li>
        <li class="nav-item">
        <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">Contact</a>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab"></div>
        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">...</div>
        <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">...</div>
    </div>
</div>
{% endblock %}

{% block result_display %}
    {% if doc|length != 0 %}
        {% for d in doc %}
            {% set index = (page_id - 1)*8 + loop.index - 1 %}
            <div class="container">
                <h6>
                    <a href="{{ url_for('doc', doc_id=result_id[index]) }}">{{d.title}}</a>
                </h6>
                <div class="container">
                    <p>
                    {% for index in range(d['ingredients']|length) %}
                        <strong>{{d['ingredients'][index]}}</strong> :&nbsp; {{d['ingredients_description'][index]}}
                    {% endfor %}
                    </p>
                </div>

                <div class="progress">
                    {% for nutr, level in d['health'].items() %}
                        {% if level == "green" %}
                        <div class="progress-bar progress-bar-striped bg-success" role="progressbar" style="width: 25%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">{{nutr|capitalize}}</div>
                        {% elif level == "orange" %}
                        <div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 25%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">{{nutr|capitalize}}</div>
                        {% else %}
                        <div class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 25%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">{{nutr|capitalize}}</div>
                        {% endif %}
                    {% endfor %}
                </div>

                <p>Complexity: {{d['complexity']}}</p>
                <div class="progress">

                </div>
                <hr>
            </div>
        {% endfor %}
    {% endif %}

{% endblock %}


{% block next_page %}
<div class="container">
    <nav aria-label="...">
        <ul class="pagination mx-auto justify-content-center">
            {# Determines whether previous button disabled #}
            {% if prev_disabled %}
                <li class="page-item disabled">
                    <input type="submit" value="Previous" class="btn btn-outline-secondary btn-sm">
                </li>
            {% else %}
                <li class="page-item">
                    <form action="{{ url_for('next_page', page_id=page_id - 1)}}" name="Prev_page" method="post">
                        <input name="results" type="hidden" value="{{ results }}">
                        <input name="result_id" type="hidden" value="{{ result_id }}">
                        <input name="query_text" type="hidden" value="{{ query_text }}">
                        <input name="num_page" type="hidden" value="{{ num_page }}">
                        <input type="submit" value="Previous" class="btn btn-outline-secondary btn-sm">
                    </form>
                </li>
            {% endif %}

            {% for id in range(num_page) %}
                <li class="page-item">
                    <form action="{{ url_for('next_page', page_id=id + 1) }}" name="Pagination" method="post">
                        <input name="results" type="hidden" value="{{ results }}">
                        <input name="result_id" type="hidden" value="{{ result_id }}">
                        <input name="query_text" type="hidden" value="{{ query_text }}">
                        <input name="num_page" type="hidden" value="{{ num_page }}">
                        <input type="submit" value="{{ id + 1 }}" class="btn btn-outline-secondary btn-sm">
                    </form>
                </li>
            {% endfor %}

            {# Determines whether next button disabled #}
            {% if next_disabled %}
                <li class="page-item disabled">
                    <input type="submit" value="Next" class="btn btn-outline-secondary btn-sm">
                </li>
            {% else %}
                <li class="page-item">
                    <form action="{{ url_for('next_page', page_id=page_id + 1) }}" name="Pagination" method="post">
                        <input name="results" type="hidden" value="{{ results }}">
                        <input name="result_id" type="hidden" value="{{ result_id }}">
                        <input name="query_text" type="hidden" value="{{ query_text }}">
                        <input name="num_page" type="hidden" value="{{ num_page }}">
                        <input type="submit" value="Next" class="btn btn-outline-secondary btn-sm">
                    </form>
                </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endblock %}